{"kind":"article","abstract":[{"type":"text","text":"This document provides a high-level overview of key development practices when integrating with MoovKit."}],"schemaVersion":{"minor":3,"major":0,"patch":0},"hierarchy":{"paths":[["doc:\/\/io.moov.MoovKit\/documentation\/MoovKit"]]},"variants":[{"paths":["\/documentation\/moovkit\/developer-guidelines"],"traits":[{"interfaceLanguage":"swift"}]},{"traits":[{"interfaceLanguage":"occ"}],"paths":["\/documentation\/moovkit\/developer-guidelines"]}],"sections":[],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Developer-Guidelines"},"metadata":{"roleHeading":"Article","modules":[{"name":"MoovKit"}],"role":"article","title":"Developer Guidelines"},"primaryContentSections":[{"content":[{"type":"heading","anchor":"Overview","level":2,"text":"Overview"},{"inlineContent":[{"text":"MoovKit is built in alignment with Apple’s ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","isActive":true},{"text":". Developers must follow these guidelines, with special attention to the sections on enabling Tap to Pay on iPhone and educating merchants.","type":"text"}],"type":"paragraph"},{"level":2,"text":"Tap to Pay on iPhone preparation","anchor":"Tap-to-Pay-on-iPhone-preparation","type":"heading"},{"type":"paragraph","inlineContent":[{"text":"Once the Tap to Pay on iPhone terms and conditions are accepted, ensure that its status is verified early — ideally upon app launch—and not only during the checkout process. This check ensures the device is capable of reading contactless cards and is properly configured to process transactions.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Manage this flow carefully to allow merchants to process payments without delays. Avoid requiring merchants to link an Apple ID or wait for terminal initialization during checkout. When "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true},{"type":"text","text":" is called for the first time, device configuration continues even if the app is closed."}]},{"anchor":"Handling-Background-states","text":"Handling Background states","level":2,"type":"heading"},{"inlineContent":[{"text":"For security reasons, the reader session is invalidated when the app moves to the background. To restore functionality promptly, call ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","type":"reference","isActive":true},{"type":"text","text":" immediately when the app returns to the foreground."}],"type":"paragraph"},{"inlineContent":[{"text":"To optimize performance, MoovKit retains the most recent terminal configuration in memory (if still valid) and reuses it for subsequent ","type":"text"},{"code":"Moov\/createSession(invalidateTerminalConfiguration:)","type":"codeVoice"},{"text":" calls. It does not persist the configuration to disk. If the app is terminated, MoovKit will request a new configuration from the host app.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"You may choose to persist the configuration locally and provide it to MoovKit on request, as long as it hasn’t expired. By default, terminal configurations expire 48 hours after being fetched from the Moov platform."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Your app should also support terminal configuration updates within the same day—even if the current configuration has not expired. Use push notifications or a frequently checked flag to notify the app when a new configuration is needed. Then, call ","type":"text"},{"isActive":true,"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","type":"reference"},{"text":" with ","type":"text"},{"type":"codeVoice","code":"true"},{"type":"text","text":" to force an update."}]},{"level":2,"type":"heading","text":"Device and iOS version support","anchor":"Device-and-iOS-version-support"},{"inlineContent":[{"type":"text","text":"Ensure the app is running on a compatible device and iOS version. On iOS 15.4+ or iPadOS 15.5+, use "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/isPaymentCardSupported()","isActive":true},{"text":" to verify device compatibility.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Note: iOS version support is only validated during the "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true},{"type":"text","text":" call. If the iOS version is unsupported, a "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/osVersionNotSupported(_:)","isActive":true},{"text":" is thrown, indicating that the user should update their device.","type":"text"}],"type":"paragraph"},{"level":2,"text":"Tap to Pay on iPhone entitlement","anchor":"Tap-to-Pay-on-iPhone-entitlement","type":"heading"},{"inlineContent":[{"text":"MoovKit verifies entitlement during the ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/initReader(reader:)"},{"text":" call. If the required entitlement is missing, it throws ``CardReaderError\/notAllowed(_)`.","type":"text"}],"type":"paragraph"},{"anchor":"Terminal-Configuration-Compatibility","type":"heading","text":"Terminal Configuration Compatibility","level":2},{"inlineContent":[{"type":"text","text":"Each terminal configuration has a minimum supported iOS version. If an incompatible configuration is used, "},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"type":"text","text":" returns "},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/prepareFailed(_:)","isActive":true,"type":"reference"},{"text":" with the message:","type":"text"},{"text":"\n","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"“Reader configuration incompatible baseline (2031).”"}]},{"type":"text","text":""},{"text":"\n","type":"text"},{"type":"text","text":"In such cases, prompt the merchant to update their device or use a compatible terminal configuration."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"type":"text","text":"To ensure smooth switching, call "},{"type":"reference","isActive":true,"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"text":" with ","type":"text"},{"code":"true","type":"codeVoice"},{"text":" when a new configuration is required.","type":"text"}]},{"type":"heading","level":2,"anchor":"Presenting-Tap-to-Pay-Terms-and-Conditions","text":"Presenting Tap to Pay Terms and Conditions"},{"type":"paragraph","inlineContent":[{"type":"text","text":"You can present the Tap to Pay on iPhone terms and conditions using ``Moov\/presentTermsAndConditions()`."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"While "},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"type":"text","text":" can automatically show the T&C if they haven’t been accepted, it’s recommended to manage this flow separately—outside of the checkout experience—for better UX."}]},{"type":"paragraph","inlineContent":[{"text":"Once T&C have been accepted, call ","type":"text"},{"type":"reference","isActive":true,"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"text":" as early as possible to configure the device.","type":"text"}]},{"anchor":"User-interface-Considerations","level":2,"type":"heading","text":"User interface Considerations"},{"inlineContent":[{"text":"Wait for the ","type":"text"},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/ReaderEvent\/userInterfaceDismissed","isActive":true},{"type":"text","text":" event before rendering or updating your app’s UI, or before initiating another method call."}],"type":"paragraph"},{"text":"createSession","anchor":"createSession","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"Call "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true},{"type":"text","text":" as soon as the app returns to the foreground. This reinstates the reader session promptly, allowing the merchant to interact with the terminal without unnecessary delays."}],"type":"paragraph"},{"anchor":"createTapAuthorization","type":"heading","level":3,"text":"createTapAuthorization"},{"type":"paragraph","inlineContent":[{"text":"At checkout, when the Tap to Pay on iPhone button is tapped, call ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)","type":"reference","isActive":true},{"text":" immediately to initiate the transaction and display the payment sheet.","type":"text"}]},{"inlineContent":[{"type":"text","text":"To minimize latency:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Avoid placing backend calls or blocking checks before initiating the read.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Perform any additional processing in parallel or after the tap."}]}]}]},{"inlineContent":[{"type":"text","text":"If "},{"type":"reference","isActive":true,"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"type":"text","text":" hasn’t completed by the time the button is tapped, display a full-screen progress indicator (e.g., “Preparing… 95%”) and automatically invoke "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)","isActive":true},{"text":" once the session setup completes.","type":"text"}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"Refer to Apple’s ","type":"text"},{"identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","overridingTitleInlineContent":[{"text":"Human Interface Guidelines","type":"text"}],"overridingTitle":"Human Interface Guidelines","isActive":true,"type":"reference"},{"type":"text","text":" for more detail."}]},{"anchor":"Managing-iOS-Versions-and-Deprecations","type":"heading","text":"Managing iOS Versions and Deprecations","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Review the following for technical guidance on managing different iOS versions and deprecation dates for releases."}]},{"text":"Guidance for iOS 18.4 and Later","level":3,"anchor":"Guidance-for-iOS-184-and-Later","type":"heading"},{"inlineContent":[{"type":"text","text":"iOS 18.4 introduces update reminders in the Tap to Pay UI when nearing deprecation for the current iOS version."}],"type":"paragraph"},{"type":"paragraph","inlineContent":[{"text":"These reminders are triggered during ``Moov\/createSession(invalidateTerminalConfiguration:)`, are localized to the merchant’s language, and include a link to Software Update in Settings.","type":"text"}]},{"inlineContent":[{"type":"text","text":"The alert cadence is:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Once a week"}]},{"type":"text","text":" starting "},{"inlineContent":[{"type":"text","text":"90 days before deprecation"}],"type":"strong"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Once a day","type":"text"}],"type":"strong"},{"text":" starting ","type":"text"},{"inlineContent":[{"text":"3 days before deprecation","type":"text"}],"type":"strong"}]}]}]},{"type":"heading","anchor":"Target-the-Latest-iOS-Version","level":3,"text":"Target the Latest iOS Version"},{"type":"paragraph","inlineContent":[{"text":"Although Tap to Pay on iPhone has been supported since iOS 15.4, terminal provisioning is only supported on versions within ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"1 year"}]},{"type":"text","text":" of their release. Developers are encouraged to target the latest major iOS version."}]}],"kind":"content"}],"references":{"doc://io.moov.MoovKit/documentation/MoovKit/Moov/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)":{"role":"symbol","abstract":[{"type":"text","text":"Accept and authorize a payment."}],"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)","type":"topic","title":"createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)","url":"\/documentation\/moovkit\/moov\/createtapauthorization(for:currencycode:transactiontype:customeraccountid:)","kind":"symbol","fragments":[{"text":"func","kind":"keyword"},{"kind":"text","text":" "},{"text":"createTapAuthorization","kind":"identifier"},{"kind":"text","text":"("},{"text":"for","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"c:@SA@NSDecimal","text":"Decimal","kind":"typeIdentifier"},{"kind":"text","text":", "},{"text":"currencyCode","kind":"externalParam"},{"kind":"text","text":": "},{"preciseIdentifier":"s:7MoovKit12CurrencyCodeO","kind":"typeIdentifier","text":"CurrencyCode"},{"text":", ","kind":"text"},{"kind":"externalParam","text":"transactionType"},{"kind":"text","text":": "},{"text":"TransactionType","kind":"typeIdentifier","preciseIdentifier":"s:7MoovKit15TransactionTypeO"},{"text":", ","kind":"text"},{"text":"customerAccountId","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:10Foundation4UUIDV","kind":"typeIdentifier","text":"UUID"},{"text":"?) ","kind":"text"},{"kind":"keyword","text":"async"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"kind":"text","text":" -> "},{"text":"AuthorizationResponse","kind":"typeIdentifier","preciseIdentifier":"s:7MoovKit21AuthorizationResponseV"}]},"doc://io.moov.MoovKit/documentation/MoovKit/Moov/isPaymentCardSupported()":{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/isPaymentCardSupported()","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"isPaymentCardSupported"},{"kind":"text","text":"() -> "},{"text":"Bool","preciseIdentifier":"s:Sb","kind":"typeIdentifier"}],"url":"\/documentation\/moovkit\/moov\/ispaymentcardsupported()","abstract":[{"text":"Returns true if this device can provide payment card reader functionality.","type":"text"}],"type":"topic","title":"isPaymentCardSupported()","role":"symbol","kind":"symbol"},"doc://io.moov.MoovKit/documentation/MoovKit":{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit","role":"collection","title":"MoovKit","url":"\/documentation\/moovkit","abstract":[],"type":"topic","kind":"symbol"},"https://developer.apple.com/design/human-interface-guidelines/tap-to-pay-on-iphone":{"url":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","title":"Tap to Pay on iPhone Human Interface Guidelines","titleInlineContent":[{"type":"text","text":"Tap to Pay on iPhone Human Interface Guidelines"}],"type":"link"},"doc://io.moov.MoovKit/documentation/MoovKit/Moov/createSession(invalidateTerminalConfiguration:)":{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","kind":"symbol","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"createSession"},{"text":"(","kind":"text"},{"text":"invalidateTerminalConfiguration","kind":"externalParam"},{"text":": ","kind":"text"},{"preciseIdentifier":"s:Sb","kind":"typeIdentifier","text":"Bool"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"}],"url":"\/documentation\/moovkit\/moov\/createsession(invalidateterminalconfiguration:)","abstract":[{"text":"Creates a payment session.","type":"text"}],"role":"symbol","title":"createSession(invalidateTerminalConfiguration:)","type":"topic"},"doc://io.moov.MoovKit/documentation/MoovKit/CardReaderError/prepareFailed(_:)":{"abstract":[{"type":"text","text":"An error that indicates preparation failed."}],"url":"\/documentation\/moovkit\/cardreadererror\/preparefailed(_:)","fragments":[{"kind":"keyword","text":"case"},{"text":" ","kind":"text"},{"text":"prepareFailed","kind":"identifier"},{"text":"(","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"},{"text":"?)","kind":"text"}],"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/prepareFailed(_:)","kind":"symbol","title":"CardReaderError.prepareFailed(_:)","role":"symbol","type":"topic"},"doc://io.moov.MoovKit/documentation/MoovKit/ReaderEvent/userInterfaceDismissed":{"fragments":[{"text":"case","kind":"keyword"},{"kind":"text","text":" "},{"text":"userInterfaceDismissed","kind":"identifier"}],"kind":"symbol","type":"topic","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/ReaderEvent\/userInterfaceDismissed","abstract":[{"type":"text","text":"An event that indicates the UI has been closed."}],"title":"ReaderEvent.userInterfaceDismissed","url":"\/documentation\/moovkit\/readerevent\/userinterfacedismissed","role":"symbol"},"doc://io.moov.MoovKit/documentation/MoovKit/Moov/initReader(reader:)":{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/initReader(reader:)","fragments":[{"text":"func","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"initReader"},{"text":"(","kind":"text"},{"text":"reader","kind":"externalParam"},{"kind":"text","text":": "},{"text":"CardReader","kind":"typeIdentifier","preciseIdentifier":"s:7MoovKit10CardReaderP"},{"kind":"text","text":") "},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"keyword","text":"throws"},{"text":" -> ","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"}],"url":"\/documentation\/moovkit\/moov\/initreader(reader:)","abstract":[{"type":"text","text":"Initializes the reader to accept payments."}],"type":"topic","title":"initReader(reader:)","role":"symbol","kind":"symbol"},"doc://io.moov.MoovKit/documentation/MoovKit/CardReaderError/osVersionNotSupported(_:)":{"role":"symbol","abstract":[{"type":"text","text":"An error that indicates the current OS version isn’t supported."}],"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/osVersionNotSupported(_:)","type":"topic","kind":"symbol","url":"\/documentation\/moovkit\/cardreadererror\/osversionnotsupported(_:)","title":"CardReaderError.osVersionNotSupported(_:)","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"osVersionNotSupported"},{"text":"(","kind":"text"},{"text":"String","preciseIdentifier":"s:SS","kind":"typeIdentifier"},{"kind":"text","text":")"}]}},"variantOverrides":[{"traits":[{"interfaceLanguage":"occ"}],"patch":[{"op":"replace","path":"\/identifier\/interfaceLanguage","value":"occ"},{"path":"\/topicSections","value":null,"op":"add"},{"op":"add","path":"\/seeAlsoSections","value":null}]}]}