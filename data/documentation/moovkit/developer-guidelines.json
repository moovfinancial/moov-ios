{"kind":"article","sections":[],"metadata":{"role":"article","title":"Developer Guidelines","roleHeading":"Article","modules":[{"name":"MoovKit"}]},"variants":[{"paths":["\/documentation\/moovkit\/developer-guidelines"],"traits":[{"interfaceLanguage":"swift"}]},{"paths":["\/documentation\/moovkit\/developer-guidelines"],"traits":[{"interfaceLanguage":"occ"}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"primaryContentSections":[{"content":[{"text":"Overview","anchor":"Overview","type":"heading","level":2},{"inlineContent":[{"text":"MoovKit is built in alignment with Apple’s ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","isActive":true},{"text":". We strongly suggest you familiarize yourself with the ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone#Enabling-Tap-to-Pay-on-iPhone","isActive":true},{"text":" and ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone#Educating-merchants","isActive":true},{"text":" sections.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Developers must follow Apple’s guidelines."}],"type":"paragraph"},{"text":"Tap to Pay on iPhone preparation","anchor":"Tap-to-Pay-on-iPhone-preparation","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Once the terms and conditions for Tap to Pay on iPhone are accepted, ensure its status is verified early. Ideally, status is verified upon app launch and not during the checkout process. Verification ensures the device is capable of reading contactless cards and is configured to process transactions."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Manage this flow carefully to allow merchants to process payments without delays. Avoid requiring merchants to link an Apple ID or wait for terminal initialization during checkout. When "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true},{"type":"text","text":" is called for the first time, device configuration continues even if the app is closed."}],"type":"paragraph"},{"text":"Handling background states","anchor":"Handling-background-states","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"For security reasons, the reader session is invalidated when the app moves to the background. To promptly restore functionality, call "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true},{"type":"text","text":" immediately when the app returns to the foreground."}],"type":"paragraph"},{"inlineContent":[{"text":"To optimize performance, MoovKit retains the most recent terminal configuration in memory (if still valid) and reuses it for subsequent ","type":"text"},{"code":"Moov\/createSession(invalidateTerminalConfiguration:)","type":"codeVoice"},{"text":" calls. It does not persist the configuration to disk. If the app is terminated, MoovKit will request a new configuration from the host app.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"As long as the configuration hasn’t expired, you may choose to persist it locally and provide it to MoovKit on request. By default, terminal configurations expire 48 hours after being fetched from the Moov platform."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Your app should also support terminal configuration updates within the same day if the current configuration has not expired. Use push notifications, or a frequently checked flag, to notify the app when a new configuration is needed. Then, call "},{"type":"reference","isActive":true,"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"type":"text","text":" with "},{"type":"codeVoice","code":"true"},{"type":"text","text":" to force an update."}],"type":"paragraph"},{"text":"Device and iOS version support","anchor":"Device-and-iOS-version-support","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Ensure the app is running on a compatible device and iOS version. On iOS 15.4+ or iPadOS 15.5+, use "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/isPaymentCardSupported()","isActive":true},{"type":"text","text":" to verify device compatibility."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Note: iOS version support is only validated during the "},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"type":"text","text":" call. If the iOS version is unsupported, a "},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/osVersionNotSupported(_:)"},{"type":"text","text":" is thrown, indicating that the user should update their device."}],"type":"paragraph"},{"text":"Tap to Pay on iPhone entitlement","anchor":"Tap-to-Pay-on-iPhone-entitlement","type":"heading","level":2},{"inlineContent":[{"text":"MoovKit verifies entitlement during the ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/initReader(reader:)","type":"reference","isActive":true},{"text":" call. If the required entitlement is missing, it throws ``CardReaderError\/notAllowed(_)`.","type":"text"}],"type":"paragraph"},{"text":"Terminal configuration compatibility","anchor":"Terminal-configuration-compatibility","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"Each terminal configuration is required to have a minimum supported iOS version. If an incompatible configuration is used, "},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","type":"reference","isActive":true},{"type":"text","text":" returns "},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/prepareFailed(_:)","type":"reference","isActive":true},{"type":"text","text":" with the message:"},{"type":"text","text":"\n"},{"type":"strong","inlineContent":[{"text":"“Reader configuration incompatible baseline (2031).”","type":"text"}]},{"type":"text","text":""},{"type":"text","text":"\n"},{"type":"text","text":"In such cases, prompt the merchant to update their device or use a compatible terminal configuration."}],"type":"paragraph"},{"inlineContent":[{"text":"To ensure smooth switching when a new configuration is required, call ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true,"type":"reference"},{"text":" with ","type":"text"},{"code":"true","type":"codeVoice"},{"text":".","type":"text"}],"type":"paragraph"},{"text":"Presenting Tap to Pay Terms and Conditions","anchor":"Presenting-Tap-to-Pay-Terms-and-Conditions","type":"heading","level":2},{"inlineContent":[{"type":"text","text":"You can present Tap to Pay iPhone terms and conditions using ``Moov\/presentTermsAndConditions()`."}],"type":"paragraph"},{"inlineContent":[{"text":"For a better user experience, it’s recommended to manage the terms and conditions flow outside of the checkout experience. However, if terms and conditions have not been accepted, ","type":"text"},{"isActive":true,"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","type":"reference"},{"text":" can show them.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Once terms and conditions have been accepted, call ","type":"text"},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},{"text":" as early as possible to configure the device.","type":"text"}],"type":"paragraph"},{"anchor":"User-interface-considerations","text":"User interface considerations","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"Wait for the "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/ReaderEvent\/userInterfaceDismissed","isActive":true},{"type":"text","text":" event before rendering or updating your app’s UI, or before initiating another method call."}],"type":"paragraph"},{"anchor":"createSession","text":"createSession","level":3,"type":"heading"},{"inlineContent":[{"type":"text","text":"Call "},{"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true},{"type":"text","text":" as soon as the app returns to the foreground. This reinstates the reader session, allowing the merchant to interact with the terminal without unnecessary delays."}],"type":"paragraph"},{"anchor":"createTapAuthorization","text":"createTapAuthorization","level":3,"type":"heading"},{"inlineContent":[{"type":"text","text":"When the Tap to Pay on iPhone button is tapped at checkout, immediately call "},{"isActive":true,"type":"reference","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)"},{"type":"text","text":" to initiate the transaction and display the payment sheet."}],"type":"paragraph"},{"inlineContent":[{"text":"To minimize latency:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Avoid placing backend calls or blocking checks before initiating the read.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Perform any additional processing in parallel or after the tap."}]}]}],"type":"unorderedList"},{"inlineContent":[{"text":"If ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","type":"reference","isActive":true},{"text":" hasn’t completed by the time the button is tapped, display a full-screen progress indicator, for example, “Preparing… 95%”. Once the session setup completes, automatically invoke ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)","type":"reference","isActive":true},{"text":".","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Refer to Apple’s ","type":"text"},{"identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","isActive":true,"overridingTitleInlineContent":[{"text":"Human Interface Guidelines","type":"text"}],"overridingTitle":"Human Interface Guidelines","type":"reference"},{"text":" for more detail.","type":"text"}],"type":"paragraph"},{"anchor":"Managing-iOS-versions-and-deprecations","text":"Managing iOS versions and deprecations","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"Review the following for technical guidance on managing different iOS versions and deprecation dates for releases."}],"type":"paragraph"},{"anchor":"Guidance-for-iOS-184-and-later","text":"Guidance for iOS 18.4 and later","level":3,"type":"heading"},{"inlineContent":[{"text":"iOS 18.4 introduces update reminders in the Tap to Pay UI when nearing deprecation for the current iOS version.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"The reminders are triggered during ","type":"text"},{"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)","isActive":true,"type":"reference"},{"text":" are localized to the merchant’s language and include a link to ","type":"text"},{"inlineContent":[{"type":"text","text":"Settings > Software Update"}],"type":"strong"},{"text":".","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"The alert cadence is:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Once a week"}]},{"type":"text","text":" starting "},{"type":"strong","inlineContent":[{"text":"90 days before deprecation","type":"text"}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Once a day","type":"text"}],"type":"strong"},{"text":" starting ","type":"text"},{"inlineContent":[{"type":"text","text":"3 days before deprecation"}],"type":"strong"}]}]}],"type":"unorderedList"},{"anchor":"Target-the-latest-iOS-version","text":"Target the latest iOS version","level":3,"type":"heading"},{"inlineContent":[{"type":"text","text":"Although Tap to Pay on iPhone has been supported since iOS 15.4, terminal provisioning is only supported on versions within "},{"type":"strong","inlineContent":[{"text":"1 year","type":"text"}]},{"type":"text","text":" of their release. Developers are encouraged to target the latest major iOS version."}],"type":"paragraph"}],"kind":"content"}],"hierarchy":{"paths":[["doc:\/\/io.moov.MoovKit\/documentation\/MoovKit"]]},"abstract":[{"text":"This document provides a high-level overview of key development practices for MoovKit integration.","type":"text"}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Developer-Guidelines"},"references":{"doc://io.moov.MoovKit/documentation/MoovKit/Moov/isPaymentCardSupported()":{"role":"symbol","type":"topic","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/isPaymentCardSupported()","kind":"symbol","url":"\/documentation\/moovkit\/moov\/ispaymentcardsupported()","abstract":[{"type":"text","text":"Returns true if this device can provide payment card reader functionality."}],"title":"isPaymentCardSupported()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"isPaymentCardSupported"},{"kind":"text","text":"() -> "},{"kind":"typeIdentifier","preciseIdentifier":"s:Sb","text":"Bool"}]},"doc://io.moov.MoovKit/documentation/MoovKit/CardReaderError/prepareFailed(_:)":{"url":"\/documentation\/moovkit\/cardreadererror\/preparefailed(_:)","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/prepareFailed(_:)","abstract":[{"type":"text","text":"An error that indicates preparation failed."}],"kind":"symbol","type":"topic","role":"symbol","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"prepareFailed","kind":"identifier"},{"text":"(","kind":"text"},{"preciseIdentifier":"s:SS","text":"String","kind":"typeIdentifier"},{"text":"?)","kind":"text"}],"title":"CardReaderError.prepareFailed(_:)"},"doc://io.moov.MoovKit/documentation/MoovKit/Moov/initReader(reader:)":{"kind":"symbol","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/initReader(reader:)","url":"\/documentation\/moovkit\/moov\/initreader(reader:)","title":"initReader(reader:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"initReader","kind":"identifier"},{"text":"(","kind":"text"},{"text":"reader","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"CardReader","kind":"typeIdentifier","preciseIdentifier":"s:7MoovKit10CardReaderP"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"text":" -> ","kind":"text"},{"text":"String","kind":"typeIdentifier","preciseIdentifier":"s:SS"}],"abstract":[{"text":"Initializes the reader to accept payments.","type":"text"}],"type":"topic","role":"symbol"},"doc://io.moov.MoovKit/documentation/MoovKit/CardReaderError/osVersionNotSupported(_:)":{"kind":"symbol","type":"topic","abstract":[{"text":"An error that indicates the current OS version isn’t supported.","type":"text"}],"role":"symbol","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"osVersionNotSupported","kind":"identifier"},{"text":"(","kind":"text"},{"text":"String","preciseIdentifier":"s:SS","kind":"typeIdentifier"},{"text":")","kind":"text"}],"url":"\/documentation\/moovkit\/cardreadererror\/osversionnotsupported(_:)","title":"CardReaderError.osVersionNotSupported(_:)","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/CardReaderError\/osVersionNotSupported(_:)"},"doc://io.moov.MoovKit/documentation/MoovKit/Moov/createSession(invalidateTerminalConfiguration:)":{"kind":"symbol","abstract":[{"text":"Creates a payment session.","type":"text"}],"type":"topic","title":"createSession(invalidateTerminalConfiguration:)","role":"symbol","url":"\/documentation\/moovkit\/moov\/createsession(invalidateterminalconfiguration:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"createSession","kind":"identifier"},{"text":"(","kind":"text"},{"text":"invalidateTerminalConfiguration","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Bool","kind":"typeIdentifier","preciseIdentifier":"s:Sb"},{"text":") ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"}],"identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createSession(invalidateTerminalConfiguration:)"},"doc://io.moov.MoovKit/documentation/MoovKit/ReaderEvent/userInterfaceDismissed":{"url":"\/documentation\/moovkit\/readerevent\/userinterfacedismissed","role":"symbol","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/ReaderEvent\/userInterfaceDismissed","abstract":[{"type":"text","text":"An event that indicates the UI has been closed."}],"title":"ReaderEvent.userInterfaceDismissed","fragments":[{"text":"case","kind":"keyword"},{"text":" ","kind":"text"},{"text":"userInterfaceDismissed","kind":"identifier"}],"kind":"symbol","type":"topic"},"doc://io.moov.MoovKit/documentation/MoovKit/Moov/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)":{"fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"createTapAuthorization","kind":"identifier"},{"text":"(","kind":"text"},{"text":"for","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Decimal","preciseIdentifier":"c:@SA@NSDecimal","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"currencyCode","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"CurrencyCode","preciseIdentifier":"s:7MoovKit12CurrencyCodeO","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"transactionType","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"TransactionType","preciseIdentifier":"s:7MoovKit15TransactionTypeO","kind":"typeIdentifier"},{"text":", ","kind":"text"},{"text":"customerAccountId","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"UUID","preciseIdentifier":"s:10Foundation4UUIDV","kind":"typeIdentifier"},{"text":"?) ","kind":"text"},{"text":"async","kind":"keyword"},{"text":" ","kind":"text"},{"text":"throws","kind":"keyword"},{"text":" -> ","kind":"text"},{"text":"AuthorizationResponse","preciseIdentifier":"s:7MoovKit21AuthorizationResponseV","kind":"typeIdentifier"}],"kind":"symbol","url":"\/documentation\/moovkit\/moov\/createtapauthorization(for:currencycode:transactiontype:customeraccountid:)","title":"createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)","type":"topic","abstract":[{"text":"Accept and authorize a payment.","type":"text"}],"role":"symbol","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit\/Moov\/createTapAuthorization(for:currencyCode:transactionType:customerAccountId:)"},"doc://io.moov.MoovKit/documentation/MoovKit":{"type":"topic","abstract":[],"kind":"symbol","title":"MoovKit","role":"collection","url":"\/documentation\/moovkit","identifier":"doc:\/\/io.moov.MoovKit\/documentation\/MoovKit"},"https://developer.apple.com/design/human-interface-guidelines/tap-to-pay-on-iphone":{"title":"Tap to Pay on iPhone Human Interface Guidelines","type":"link","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone","titleInlineContent":[{"text":"Tap to Pay on iPhone Human Interface Guidelines","type":"text"}],"url":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone"},"https://developer.apple.com/design/human-interface-guidelines/tap-to-pay-on-iphone#Educating-merchants":{"title":"Educating Merchants","type":"link","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone#Educating-merchants","titleInlineContent":[{"text":"Educating Merchants","type":"text"}],"url":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone#Educating-merchants"},"https://developer.apple.com/design/human-interface-guidelines/tap-to-pay-on-iphone#Enabling-Tap-to-Pay-on-iPhone":{"title":"Enabling Tap to Pay on iPhone","type":"link","identifier":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone#Enabling-Tap-to-Pay-on-iPhone","titleInlineContent":[{"text":"Enabling Tap to Pay on iPhone","type":"text"}],"url":"https:\/\/developer.apple.com\/design\/human-interface-guidelines\/tap-to-pay-on-iphone#Enabling-Tap-to-Pay-on-iPhone"}},"variantOverrides":[{"patch":[{"value":"occ","path":"\/identifier\/interfaceLanguage","op":"replace"},{"value":null,"path":"\/topicSections","op":"add"},{"value":null,"path":"\/seeAlsoSections","op":"add"}],"traits":[{"interfaceLanguage":"occ"}]}]}